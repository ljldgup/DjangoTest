<!DOCTYPE html>
<html>
<head>
<title>交易统计</title>
<script type="text/javascript" src="/static/echarts.min.js"></script>
<script type="text/javascript" src="/static/jquery-3.1.1.min.js"></script>
</head>

<body>
	<!-- 为ECharts准备一个具备大小（宽高）的Dom -->
	<div id="main" style="width: 1200px;height:1000px;">
		<div id="main1" style="width: 750px;height:200px;"></div>
		<div id="main2" style="width: 750px;height:200px;"></div>
	</div>
	<script type="text/javascript">
		$.ajaxSetup({async:false});
		// 基于准备好的dom，初始化echarts实例
		var myChart1 = echarts.init(document.getElementById('main1'));
		var myChart2 = echarts.init(document.getElementById('main2'));
		// 指定图表的配置项和数据
		var option = {
			title: {
				text: 'ECharts 入门示例'
			},
			tooltip: {},
			legend: {
				data:['销量']
			},
			xAxis: {
				data: ["衬衫","羊毛衫","雪纺衫","裤子","高跟鞋","袜子"]
			},
			yAxis: {},
			series: [{
				name: '销量',
				type: 'bar',
				data: [5, 20, 36, 10, 10, 20]
			}]
		};

		//使用json初始化
		myChart1.setOption(option);
		myChart2.setOption(option);
		var stat_data;
		var test;
		var json_url = "/trade_data_json/";
		var url = self.location.href;
		params = url.split("?");
		if (params.length > 1) {
			json_url += "?" + params[1];
		}
		
		$.getJSON(json_url, function(data){
			stat_data = data;
		});
		
		var t = x_axis_gen(stat_data);
		
		$(document).ready( function () {

		});
		
		function static_data_gen(ori_data){
			
		}
		
		function x_axis_gen(data){

			var x_axis = [];
			var min_year = data[0][3].split("-")[0];
			var min_month = data[0][3].split("-")[1];
			var max_year = data[data.length-1][3].split("-")[0];
			var max_month = data[data.length-1][3].split("-")[1];
			
			var max_x = max_year + '-' + max_month
			var tmp_year = parseInt(min_year);
			var tmp_month = parseInt(min_month);
			var tmp_x = tmp_year + '-' + tmp_month
			
			while(tmp_x <= max_x ){
				x_axis.push(tmp_x);
				if(tmp_month < 12){
					tmp_month+=1;
				}else{
					tmp_month = 1;
					tmp_year++;
				}
				if (tmp_month < 10) {
					tmp_x = tmp_year + '-0' + tmp_month;
				}
				else{
					tmp_x = tmp_year + '-' + tmp_month;
				}
				
				console.log('tmp:' + tmp_x);
				console.log('max:' + max_x);
			}
			return x_axis;
		}
		
	</script>
</body>
</html>
