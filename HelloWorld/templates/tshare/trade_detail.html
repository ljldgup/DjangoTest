<!DOCTYPE html>
<html>
<head>
<title>{{r_name}}交易明细</title>
<script type="text/javascript" src="/static/echarts.min.js"></script>
<link href="/static/jquery.dataTables.css" rel="stylesheet"
	type="text/css" />
<script type="text/javascript" src="/static/jquery-3.1.1.min.js"></script>
<script src="/static/jquery.dataTables.js" type="text/javascript"></script>
</head>
<body style="background: rgb(250, 250, 255)">
	<div style="width: 1250px; float: left;">
	<br><br>
		{% include 'tshare\k-lines.html' %}
		<div style="width: 450px; float: right;margin-right: 20px;">
			<h3>交易明细</h3>
			<table id="detail_data" border="1">
				<thead>
					<tr>
						<th>日期</th>
						<th>手数</th>
						<th>价格</th>
						<th>持有手数</th>
						<th>盈亏</th>
					</tr>
				</thead>

				<tbody>
					{% for i in ori_data %}
					<tr>
						<td>{{i.date|date:'Y-m-d'}}</td>
						<td>{{i.amount}}</td>
						<td>{{i.price}}</td>
						<td>{{i.getamount}}</td> {% if i.getamount > 0 %}
						<td>-</td> {% else %} {% if i.getsum > 0 %}
						<td style="color: red">{{i.getsum}}</td> {% else %}
						<td style="color: green">{{i.getsum}}</td> {% endif %} {% endif %}
					</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
		<div style="width: 740px; float: left;margin-left: 20px;">
			<!--纵向滚动条，英语换行-->
			<div style="width: 720px; float: left; margin-left: 20px; max-height: 430px; OVERFLOW-Y: auto; OVERFLOW-X:auto; word-break:break-all"  id="note_area">
				{% for i in note %}
				<div style="width: 700px; float: left;">
					'{{i.t_date}}':<br>'{{i.t_content}}'
				</div>
				{% endfor %}
			</div>
			<br>
			<form action="/add_note/" method="get" style="margin-left: 20px; float: left; width: 710px;" id="write_note">
				时间<input type="date" name="r_date" value=""  id="r_date"/> 
					<input type="hidden" value="{{r_code}}" name="r_code"/>
					<input type="hidden" value="{{r_name}}" name="r_name"/>
					<input type="hidden" value="operation" name="r_type"/>
					<input type="hidden" value="" name="r_url" id = "r_url"/>
					<br>
					<br>
				<div id="show_box" style="width:740; min-height=200; border: 1px solid gray; margin-left: 20px;"></div>
					<br>
					<br>
					<input type="submit" value="提交">
			</form>
		</div>

	</div>
	<script>
		//用于观察div 排版
		//$('div').css({"color":"red","border":"2px solid red"});
		$(document).ready( function () {
			$('#detail_data').DataTable();
			var date = new Date();
			var dateString = date.getFullYear() + "-" + (date.getMonth() + 1) + "-" + date.getDate();
			$('#r_date').val(dateString);
			$('#r_url').val(self.location.href);
			
			var E = window.wangEditor;
			var editor = new E('#show_box');
			editor.customConfig.menus = [
				'bold',  // 粗体
				'fontSize',  // 字号
				'strikeThrough',  // 删除线
				'foreColor',  // 文字颜色
				'link',  // 插入链接
				'list',  // 列表
				'justify',  // 对齐方式
				'image',  // 插入图片
				'table',  // 表格
				'undo',  // 撤销
				'redo'  // 重复
			]
			editor.create();
			
			//替换笔记中的空格和换行
			$("#note_area").find("div").each(function(){
				$(this).html($(this).html().replace(/\ +/g,"&nbsp"));
				$(this).html($(this).html().replace(/[ ]/g,"&nbsp"));
				$(this).html($(this).html().replace(/[\r\n]/g,"<br>"));
			});
		});
	</script>
	<script src="/static/wangEditor/wangEditor.js"></script>
	<link href="/static/wangEditor/wangEditor.css" rel="stylesheet">
</body>
</html>
